{% extends "project/project.html" %}

{% load static %}

{% block title %}Project Metadata - {{ project }}{% endblock %}

{% block local_js_top %}
<script type="text/javascript" src="{% static 'custom/js/cookie.js' %}"></script>
<script type="text/javascript" src="{% static 'project/js/dynamic-formset.js' %}"></script>
{% endblock %}

{% block main_content %}
<h2 class="form-signin-heading">2. Project Metadata</h2>
<hr>
<p>Required fields are indicated by a <a style="color:red">*</a>. Only the submitting author may edit the metadata.</p>
<hr>

<form action="{% url 'project_metadata' project.id %}" onsubmit="return validateItems('reference-list', 'description', 'References')" method="post">
  {{ description_form.media }}
  {% include "project/metadata_inline_form_snippet.html" with form=description_form %}
  {% include 'project/item_list.html' with item="reference" item_label="References" formset=reference_formset form_name="project-reference-content_type-object_id" add_item_url=add_item_url remove_item_url=remove_item_url %}
  <button class="btn btn-lg btn-primary" type="submit" name="edit_description">Save Description</button>
</form>
<br>
<hr>

<script>
  // Disable submission for non-submitting authors
  {% if user != project.submitting_author %}
    $('button').attr('disabled',true);
    $('input').attr('disabled',true);
    $('select').attr('disabled',true);
  {% endif %}
</script>
{% endblock %}

{% block local_js_bottom %}
<script type="text/javascript" src="{% static 'custom/js/resize-ck.js' %}"></script>
<script type="text/javascript" src="{% static 'custom/js/enable-popover.js' %}"></script>
{% endblock %}
